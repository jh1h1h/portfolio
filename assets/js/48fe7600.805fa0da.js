"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[1731],{3036:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"procedure/WinPEAS","title":"WinPEAS","description":"Search for [+]","source":"@site/docs/procedure/WinPEAS.md","sourceDirName":"procedure","slug":"/procedure/WinPEAS","permalink":"/portfolio/docs/procedure/WinPEAS","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1765120889000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Password protected files","permalink":"/portfolio/docs/procedure/Password protected files"},"next":{"title":"Wordpress","permalink":"/portfolio/docs/procedure/Wordpress"}}');var r=t(4848),s=t(8453);const o={},c=void 0,l={},a=[{value:"Search for <code>[+]</code>",id:"search-for-",level:2},{value:"Plaintext Pws",id:"plaintext-pws",level:2},{value:"Section: Services Information",id:"section-services-information",level:2},{value:"Section: Service Permissions and Unquoted Service Paths",id:"section-service-permissions-and-unquoted-service-paths",level:3},{value:"Section: Interesting Services",id:"section-interesting-services",level:3},{value:"Section: Interesting Files and registry",id:"section-interesting-files-and-registry",level:2},{value:"Look for &quot;AlwaysInstallElevated&quot;",id:"look-for-alwaysinstallelevated",level:2},{value:"Section: Current Token Privileges",id:"section-current-token-privileges",level:2},{value:"Section: Checking write permissions in PATH folders",id:"section-checking-write-permissions-in-path-folders",level:2},{value:"Section: Scheduled Applications",id:"section-scheduled-applications",level:2}];function d(e){const i={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Details:t}=i;return t||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.h2,{id:"search-for-",children:["Search for ",(0,r.jsx)(i.code,{children:"[+]"})]}),"\n",(0,r.jsx)(i.p,{children:"Look for these symbols and then search how to exploit them."}),"\n",(0,r.jsx)(i.h2,{id:"plaintext-pws",children:"Plaintext Pws"}),"\n",(0,r.jsxs)(i.p,{children:["under ",(0,r.jsx)(i.code,{children:"autologon"})," section, or search for 'password' or 'creds' in the output"]}),"\n",(0,r.jsx)(i.h2,{id:"section-services-information",children:"Section: Services Information"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)(i.h3,{id:"section-service-permissions-and-unquoted-service-paths",children:"Section: Service Permissions and Unquoted Service Paths"}),(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:'Get-CimInstance Win32_Service | ? {$_.Name -eq "<ServiceName>"} | select Name, StartName, PathName'})," then ",(0,r.jsx)(i.code,{children:'icacls "C:\\Program Files\\Some App"'})," for each of the parent folders and see if have modify or full perms. If the StartName is high priv, u can override the exe and then restart the service."]}),(0,r.jsx)(i.h3,{id:"section-interesting-services",children:"Section: Interesting Services"}),(0,r.jsxs)(t,{children:[(0,r.jsx)(i.p,{children:"Auto/Manual/Disabled: Auto - on system boot, Manual - find a trigger or start it yourself if u hv perms, Disabled - not startable"}),(0,r.jsx)(i.p,{children:"Running/Stopped - running means changes will take effect when u restart, stopped means u just gotta start it. nothingburger honestly"}),(0,r.jsxs)(i.p,{children:["look for auto or manual but triggerable. then do ",(0,r.jsx)(i.code,{children:"sc qc <service name>"})," [on cmd] (eg ",(0,r.jsx)(i.code,{children:"sc qc bd"})," if the service says ",(0,r.jsx)(i.code,{children:'bd(BarracudaDrive ( bd ) service)["C:\\bd\\bd.exe"] - Auto - Running'}),"). if its running with ",(0,r.jsx)(i.code,{children:"SERVICE_START_NAME"})," , see if its in the list below:"]}),(0,r.jsxs)(t,{children:[(0,r.jsx)(i.p,{children:"Tier 1: These accounts grant you immediate, high-level access on the local machine."}),(0,r.jsx)(i.p,{children:"Tier 2: These accounts can lead to domain-level compromise, which is often more valuable than a single machine."}),(0,r.jsx)(i.p,{children:"Tier 3: These accounts have significant privileges on the local machine and can often be leveraged for elevation."}),(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Tier"}),(0,r.jsx)(i.th,{children:"Account"}),(0,r.jsx)(i.th,{children:"Description"}),(0,r.jsx)(i.th,{children:"Why It's Valuable"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 1: Highest Value Targets"}),(0,r.jsx)(i.td,{children:"LocalSystem (or NT AUTHORITY\\SYSTEM)"}),(0,r.jsx)(i.td,{children:"The most powerful local account. Has unrestricted access to the entire local system."}),(0,r.jsx)(i.td,{children:"The jackpot. Compromising a service running as SYSTEM gives you full control over the machine."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 1: Highest Value Targets"}),(0,r.jsx)(i.td,{children:"Administrator"}),(0,r.jsx)(i.td,{children:"The built-in local administrator account."}),(0,r.jsx)(i.td,{children:"Effectively the same as SYSTEM for most purposes. Full control over the local machine."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 1: Highest Value Targets"}),(0,r.jsx)(i.td,{children:"MachineName\\Administrator"}),(0,r.jsx)(i.td,{children:"Another local admin account."}),(0,r.jsx)(i.td,{children:"Full control over the local machine."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 1: Highest Value Targets"}),(0,r.jsx)(i.td,{children:"Any User in the Administrators group (e.g., DESKTOP-ABC123\\John)"}),(0,r.jsx)(i.td,{children:"A custom local admin account."}),(0,r.jsx)(i.td,{children:"Full control over the local machine."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 2: High Value Domain Targets"}),(0,r.jsx)(i.td,{children:"DOMAIN\\Domain Admins"}),(0,r.jsx)(i.td,{children:"A member of the Domain Admins group."}),(0,r.jsx)(i.td,{children:"The domain jackpot. Compromising this gives you administrative control over the entire Active Directory domain."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 2: High Value Domain Targets"}),(0,r.jsx)(i.td,{children:"DOMAIN\\Account-Name"}),(0,r.jsx)(i.td,{children:"Any other domain user."}),(0,r.jsx)(i.td,{children:"While not a local admin on every machine, this can be used for lateral movement. You can use these credentials with tools like psexec.py or wmiexec.py to see which other machines this user has admin rights on. You can also check their domain privileges with BloodHound."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 3: Medium Value Local Accounts"}),(0,r.jsx)(i.td,{children:"NT AUTHORITY\\LOCAL SERVICE"}),(0,r.jsx)(i.td,{children:"A built-in account with limited privileges on the local computer. It presents anonymous credentials to remote servers."}),(0,r.jsx)(i.td,{children:"Has more privileges than a standard user. It can often be leveraged to read sensitive files or, combined with other vulnerabilities, lead to full SYSTEM access."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 3: Medium Value Local Accounts"}),(0,r.jsx)(i.td,{children:"NT AUTHORITY\\NETWORK SERVICE"}),(0,r.jsx)(i.td,{children:"A built-in account similar to LOCAL SERVICE, but it authenticates to remote servers as the computer account (MACHINE$)."}),(0,r.jsx)(i.td,{children:"Similar to LOCAL SERVICE, but its ability to authenticate over the network as the machine account can be very interesting in a domain environment for Kerberos attacks."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 4: Lower Value / Context-Dependent"}),(0,r.jsx)(i.td,{children:"A Standard User Account (e.g., DESKTOP-ABC123\\User123)"}),(0,r.jsx)(i.td,{children:"A regular, non-privileged local user."}),(0,r.jsx)(i.td,{children:"Usually not valuable for local privilege escalation (you can't escalate to a level you're already at). However, it can be useful for persistence (maintaining access) or if that user has privileges on other machines."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Tier 4: Lower Value / Context-Dependent"}),(0,r.jsx)(i.td,{children:"NT AUTHORITY\\IUSR, NT SERVICE\\AppPool etc."}),(0,r.jsx)(i.td,{children:"Built-in accounts for IIS and other services."}),(0,r.jsx)(i.td,{children:"Typically have very low privileges. While a service running as one of these is unlikely to be a direct path to SYSTEM, it could be part of a chain of attacks (e.g., reading a web.config file that contains credentials for a more powerful account)."})]})]})]})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"section-interesting-files-and-registry",children:"Section: Interesting Files and registry"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)(i.p,{children:"True positives:"}),(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:".config"}),", ",(0,r.jsx)(i.code,{children:".xml"}),", ",(0,r.jsx)(i.code,{children:".ini"})," files under ",(0,r.jsx)(i.code,{children:"C:\\Users"}),", ",(0,r.jsx)(i.code,{children:"C:\\ProgramData"}),", etc."]}),"\n",(0,r.jsxs)(i.li,{children:["Plaintext creds like ",(0,r.jsx)(i.code,{children:"password="}),", ",(0,r.jsx)(i.code,{children:"ConnectionString="})]}),"\n"]})]}),"\n",(0,r.jsx)(i.h2,{id:"look-for-alwaysinstallelevated",children:'Look for "AlwaysInstallElevated"'}),"\n",(0,r.jsxs)(i.p,{children:["If both HKLM and HKCU show ",(0,r.jsx)(i.code,{children:"AlwaysInstallElevated: 1"}),", exploit with a malicious .msi. Ignore if only one AlwaysInstallElevated is 1"]}),"\n",(0,r.jsx)(i.h2,{id:"section-current-token-privileges",children:"Section: Current Token Privileges"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)(i.p,{children:"If you see any of these (disabled or enabled don't matter), stop what you're doing and Google \"exploit [privilege name]\".\xa0Tools like\xa0JuicyPotato,\xa0PrintSpoofer, or\xa0RogueWinRM\xa0are commonly used for this:"}),(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeImpersonatePrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeAssignPrimaryPrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeTcbPrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeBackupPrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeRestorePrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeCreateTokenPrivilege"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.code,{children:"SeLoadDriverPrivilege"})}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"SeDebugPrivilege"}),"\r\nSeShutdownPrivilege is another privilege that allows u to do shutdown /r to restart the machine (if u need it for autostarting services)"]}),"\n"]})]}),"\n",(0,r.jsx)(i.h2,{id:"section-checking-write-permissions-in-path-folders",children:"Section: Checking write permissions in PATH folders"}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsxs)(i.p,{children:["True positive if writable and appears before ",(0,r.jsx)(i.code,{children:"C:\\Windows\\System32"}),"."]}),(0,r.jsx)(i.p,{children:"If so, run:"}),(0,r.jsxs)(i.p,{children:["find services that reference ",(0,r.jsx)(i.code,{children:"<text>"})," in path: ",(0,r.jsx)(i.code,{children:"Get-CimInstance Win32_Service | Where-Object { $*.PathName -and $*.PathName -match '<text>' } | Select-Object Name,DisplayName,StartName,PathName | Format-List"})]}),(0,r.jsxs)(i.p,{children:["find scheduled tasks that have ",(0,r.jsx)(i.code,{children:"<string/pattern>"}),": ",(0,r.jsx)(i.code,{children:"schtasks /Query /FO LIST /V | Select-String -Pattern '<pattern>' -CaseSensitive:$false"})]}),(0,r.jsxs)(i.p,{children:["find startup/run keys that have ",(0,r.jsx)(i.code,{children:"<string/pattern>"}),": ",(0,r.jsx)(i.code,{children:"Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run,HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run -ErrorAction SilentlyContinue | Out-String -Stream | Select-String -Pattern '<pattern>' -CaseSensitive:$false"})]}),(0,r.jsx)(i.p,{children:"If found, then [WIP]."})]}),"\n",(0,r.jsx)(i.h2,{id:"section-scheduled-applications",children:"Section: Scheduled Applications"}),"\n",(0,r.jsx)(i.p,{children:"[WIP]"})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>c});var n=t(6540);const r={},s=n.createContext(r);function o(e){const i=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);